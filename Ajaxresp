import datetime
import cv2
import smtplib
import requests
from random import randint

# ... (Your existing code)

def is_valid_time(start_time, end_time):
    current_time = datetime.datetime.now().time()
    return start_time <= current_time <= end_time

while True:
    # Retrieve the user-set start and end times from the Flask server
    response = requests.get('http://127.0.0.1:5000/get_detection_time')
    data = response.json()
    user_start_time = datetime.datetime.strptime(data['start_time'], "%H:%M:%S").time()
    user_end_time = datetime.datetime.strptime(data['end_time'], "%H:%M:%S").time()

    if is_valid_time(user_start_time, user_end_time):
        _, frame = capture.read()
        frame = cv2.flip(frame, 1)

        class_ids, confidences, boxes = model.detect(frame)
        for id, confidence, box in zip(class_ids, confidences, boxes):
            x, y, w, h = box
            obj_class = classes[id]

            if obj_class.title() == 'Person' and j == 1:
                sendEmail()
                j = j + 1
    else:
        print("Object detection is currently disabled. Valid time range:", user_start_time, "-", user_end_time)
